var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign,Multimedia,ImageDetailSwipe;(function(n){var t;(function(){var i=ImageVisualSearchCropBox.CropBoxClientConfig,t=MmGeometry.Rectangle,r=VisualSearchCropBoxUtils.OverlayView,u=n.ImageDetailUtils.setCropBoxAnimationProperty,f=n.ImageDetailUtils.isRTL,e=function(n){function e(){var i=n.call(this)||this;return i.lastCropCoordinates=null,i.cropBoxAnimationTime=1e3,i.px="px",i.startAnimationClassName="start",i.endAnimationClassName="end",i.readyAnimationClassName="ready",i.cropBoxContentAnimationTime=1e3,i.cropBoxHintAnimationTime=3500,i.animationsRunning=!0,i.mouseButtonDown=!1,i.multiTouchMove=!1,i.containerHeight=null,i.containerWidth=null,i.hint=null,i.cropConfig=null,i.getViewRect=function(){if(!i.imageElement)return null;var n=i.imageElement.clientLeft,r=i.imageElement.clientTop,u=Math.min(i.imageElement.clientWidth,i.containerWidth),f=Math.min(i.imageElement.clientHeight,i.containerHeight),e={x:n,y:r},o={x:n+u,y:r+f};return new t(e,o)},i.getCropRect=function(n){if(!i.imageElement)return null;var o=i.imageElement.clientLeft,s=i.imageElement.clientTop,r=Math.min(i.imageElement.clientWidth,i.containerWidth),u=Math.min(i.imageElement.clientHeight,i.containerHeight),f=o+Math.round(r*n.left()),e=s+Math.round(u*n.top()),h=f+Math.round(r*n.width()),c=e+Math.round(u*n.height()),l={x:f,y:e},a={x:h,y:c};return new t(l,a)},i.start=function(n){i.overlayView!=null&&(i.startCropRect=i.overlayView.cropRect().clone(),i.overlayView.setStartPoint(n))},i.move=function(n){i.overlayView!=null&&i.startCropRect!=null&&(i.overlayView.setCurrPoint(n),i.overlayView.setCropRect(i.startCropRect.clone()),i.overlayView.update(),i.updateCropBoxStyle())},i.end=function(){i.throttleCropBoxChange()},i.cropBoxChange=function(){var n=i.getCropCoordinates(),t;n==null||i.isTinyChange()||i.lastCropCoordinates!==null&&n.equals(i.lastCropCoordinates)||(t={left:n.left(),top:n.top(),right:n.right(),bottom:n.bottom()},i.props.changeCropCoordinates(t),i.lastCropCoordinates=n)},i.setCropBoxState=function(n,r){i.startCropRect=new t(n,r);i.overlayView.setCropRect(i.startCropRect);i.overlayView.setStartPoint(n);i.overlayView.setCurrPoint(n);i.overlayView.update();i.updateCropBoxStyle()},i.updateCropBoxStyle=function(){if(i.overlayView!=null){var n=i.overlayView.cropRect();i.update(n)}},i.getCropCoordinates=function(){var u,r,n,f,e;return i.overlayView!=null&&(r=i.overlayView.cropRect(),n=i.overlayView.viewRect(),n.width()>0&&n.height()>0&&(f={x:r.left()/n.width(),y:r.top()/n.height()},e={x:r.right()/n.width(),y:r.bottom()/n.height()},u=new t(f,e))),u},i.isTinyChange=function(){return i.overlayView!=null&&i.overlayView.cropRect()!=null&&i.overlayView.cropRect().width()<=i.config.minDelta&&i.overlayView.cropRect().height()<=i.config.minDelta?!0:!1},i.throttle=function(n,t){var i,r;return function(){clearTimeout(r);var f=this,e=arguments,u=Number(new Date);i&&u<i+t?r=setTimeout(function(){i=u;n.apply(f,e)},i+t-u):(i=u,n.apply(f,e))}},i.cancelAnimation=function(n){n&&(n.classList.remove(i.startAnimationClassName),n.classList.add(i.endAnimationClassName))},i.startAnimation=function(n){n&&(n.classList.add(i.readyAnimationClassName),i.config.enableAnimations&&n.classList.add(i.startAnimationClassName))},i.endAnimation=function(n,t){var r=i.cancelAnimation;i.config.enableAnimations?setTimeout(function(){r(n)},t):i.cancelAnimation(n)},i.setAnimations=function(){i.startAnimation(i.cropBox);i.startAnimation(i.cropBoxContent);i.startAnimation(i.cropBoxHint);i.endAnimation(i.cropBox,i.cropBoxAnimationTime);i.endAnimation(i.cropBoxContent,i.cropBoxContentAnimationTime);i.endAnimation(i.cropBoxHint,i.cropBoxHintAnimationTime)},i.cancelAnimations=function(){i.animationsRunning&&(i.cancelAnimation(i.cropBox),i.cancelAnimation(i.cropBoxContent),i.cancelAnimation(i.cropBoxHint));i.animationsRunning=!1},i.update=function(n){i.cropBox&&n&&(f?i.cropBox.style.right=n.left()+i.px:i.cropBox.style.left=n.left()+i.px,i.cropBox.style.top=n.top()+i.px,i.cropBox.style.width=n.width()+i.px,i.cropBox.style.height=n.height()+i.px)},i.getOffsetPosition=function(n,t,i){var r=n.getBoundingClientRect(),u=t-r.left,f=i-r.top;return{x:u,y:f}},i.getTouchPosition=function(n,t){return i.getOffsetPosition(i.imageElement,n.touches[t].clientX,n.touches[t].clientY)},i.getMousePosition=function(n){return i.getOffsetPosition(i.imageElement,n.clientX,n.clientY)},i.onTouchStart=function(n){i.start(i.getTouchPosition(n,0))},i.onMouseDown=function(n){if(i.isPositionWithinBoundary(i.imageElement,n.clientX,n.clientY)){i.mouseButtonDown=!0;var t=i.getMousePosition(n);i.start(t)}},i.onTouchMove=function(n){if(i.config.enableMultiTouchRedraw&&n.touches.length>=2){i.multiTouchMove=!0;var t=i.getTouchPosition(n,0),r=i.getTouchPosition(n,1);i.setCropBoxState(t,r);i.stopPropagation(n)}else!i.multiTouchMove&&i.overlayView.isTransforming()&&(i.move(i.getTouchPosition(n,0)),i.stopPropagation(n))},i.onMouseMove=function(n){var t,r,u;i.mouseButtonDown&&(t=i.getMousePosition(n),i.overlayView.isTransforming()?i.move(t):i.config.enableMouseRedraw&&(r={x:t.x,y:t.y},u={x:t.x+1,y:t.y+1},i.setCropBoxState(r,u)),i.stopPropagation(n))},i.onTouchEnd=function(n){i.end();n.touches.length===0&&(i.multiTouchMove=!1);i.stopPropagation(n)},i.onMouseUp=function(){i.mouseButtonDown=!1;i.end()},i.isPositionWithinBoundary=function(n,t,i){var r=n.getBoundingClientRect();return t<r.left||t>r.right||i<r.top||i>r.bottom?!1:!0},i.hint=ImageDetailReducers.getResourceString("VSHint"),i.cropConfig=ImageDetailReducers.getCropConfig(),i}return __extends(e,n),e.prototype.componentWillMount=function(){this.props&&(this.config=new i(this.cropConfig),this.cropBoxAnimationTime=this.config.animationDuration,this.containerWidth=this.props.containerWidth,this.containerHeight=this.props.containerHeight)},e.prototype.componentDidMount=function(){var i,f,n;this.throttleCropBoxChange=this.throttle(this.cropBoxChange,this.config.eventTimeThreshold);i=this.props.cropCoordinates?this.props.cropCoordinates:this.config;f=new t({x:i.left,y:i.top},{x:i.right,y:i.bottom});this.overlayView=new r(this.getViewRect(),this.getCropRect(f),this.config);n=this.overlayView.cropRect();n&&u(n.width(),n.height(),n.left(),n.top());this.config.enableAnimations?setTimeout(this.updateCropBoxStyle,this.cropBoxAnimationTime):this.updateCropBoxStyle();this.setAnimations();this.props.cropCoordinates||this.throttleCropBoxChange()},e.prototype.componentWillReceiveProps=function(n){if(n.cropCoordinates&&this.overlayView!=null){var i=new t({x:n.cropCoordinates.left,y:n.cropCoordinates.top},{x:n.cropCoordinates.right,y:n.cropCoordinates.bottom});i.equals(this.lastCropCoordinates)&&this.containerHeight==n.containerHeight&&this.containerWidth==n.containerWidth||(this.overlayView.setViewRect(this.getViewRect()),this.overlayView.setCropRect(this.getCropRect(i)),this.updateCropBoxStyle(),this.containerHeight=n.containerHeight,this.containerWidth=n.containerWidth,this.setState({coordinates:i,containerHeight:n.containerHeight,containerWidth:n.containerWidth}))}},e.prototype.stopPropagation=function(n){n.preventDefault();n.stopPropagation()},e.prototype.render=function(){var n=this;return this.props?React.createElement("div",{id:"overlay_view",className:"overlayView",ref:function(t){n.imageElement=t},onTouchEnd:this.onTouchEnd,onTouchMove:this.onTouchMove,onTouchStart:this.onTouchStart,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp},React.createElement("div",{id:"crop_rect",className:"cropRect",ref:function(t){n.cropBox=t}},React.createElement("div",{className:"content",ref:function(t){n.cropBoxContent=t}},React.createElement("div",{className:"left"}),React.createElement("div",{className:"right"}),React.createElement("div",{className:"top"}),React.createElement("div",{className:"bottom"}),React.createElement("div",{className:"leftTop"}),React.createElement("div",{className:"rightTop"}),React.createElement("div",{className:"leftBottom"}),React.createElement("div",{className:"rightBottom"}))),React.createElement("span",{className:"cropBoxHint",ref:function(t){n.cropBoxHint=t}},this.hint)):null},e}(React.Component),o=function(n){return{changeCropCoordinates:function(t){t&&n(ImageDetailActions.changeCropCoordinates(t))}}},s=function(n){return{cropCoordinates:ImageDetailReducers.getCropCoordinates(n)}};n.ImageDetail.ImageCropBox=ReactRedux.connect(s,o)(e)})(t=n.ImageDetail||(n.ImageDetail={}))})(Multimedia||(Multimedia={})),function(n){var t;(function(t){n.ImageDetail.VisualSearchButton=function(i){if(i.onclick){var r=i.enableVSNotification&&!n.ImageDetailUtils.getVSNotificationCookie("0")?"show":"",u=ImageDetailReducers.getResourceString("VSNotificationTitle"),f=ImageDetailReducers.getResourceString("VSNotification");return React.createElement("span",{id:"vsbutton",className:r,onClick:i.onclick,"data-tooltip":i.visualSearchTooltip},React.createElement("span",{className:"icon"}),i.enableVSNotification&&!n.ImageDetailUtils.getVSNotificationCookie("0")&&React.createElement(t.NotificationContainer,{notificationTitle:u,notificationText:f,getCookie:n.ImageDetailUtils.getVSNotificationCookie,setCookie:n.ImageDetailUtils.setVSNotificationCookie}))}return null};n.ImageDetail.VisualSearchButton.displayName="VisualSearchButton"})(t=n.ImageDetail||(n.ImageDetail={}))}(Multimedia||(Multimedia={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();__assign=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},function(n){var t;(function(t){var i=n.InstrumentationUtils.logEvent,r=ImageDetailReducers.getResourceString,u=function(u){function f(n){var t=u.call(this,n)||this;return t.hotSpots=[],t.defaultHoverShown=!1,t.hoverTimeout=2e3,t.showHotspotClassName="show",t.hotSpotTooltip=null,t.changeCropCoordinatesAndLoadVisualSearch=function(n){var i,r;n&&(t.props.changeCropCoordinates(n),i=ImageDetailActions.DetailScenario.VisualSearch,t.props.detailScenario!==i&&(r=ImageDetailReducers.getAjaxUrl(i),t.props.addToDetailStateHistory(),t.props.switchDetailScenario(r)))},t.handleOnClick=function(n){var f=t.props.detectedObjects[n].boundingBox,r=f,u;t.changeCropCoordinatesAndLoadVisualSearch(r);u="left:"+r.left+", top:"+r.top;t.props.imageData&&t.props.imageData.instInfo&&i(t.props.imageData.instInfo.appNS,t.props.imageData.instInfo.kValue,"CI.Click","ObjectDetectionHotSpot",t.props.ig,{Mid:t.props.imageData.id,Info:u})},t.runHotSpotRoutine=ImageDetailReducers.isMobileViewEnabled()?t.runMobileRoutine:t.runDesktopRoutine,t.hotspotDelay=n.config?n.config.ShowHotSpotDelay:1,t.hotSpotTooltip=r("HSTooltip"),t}return __extends(f,u),f.prototype.runDesktopRoutine=function(){var t=this,i,r;if(this.defaultHoverShown){if(this.props&&this.props.config&&this.props.config.EnableFlash){for(i=0;i<this.hotSpots.length;i++)r=this.hotSpots[i],r.style.animationName="",r.style.webkitAnimationName="";setTimeout(function(){for(var i,n=0;n<t.hotSpots.length;n++)i=t.hotSpots[n],i.style.animationName="flash",i.style.webkitAnimationName="flash"},1)}}else(!this.props.enableVSNotification||n.ImageDetailUtils.getHSNotificationCookie("0"))&&setTimeout(function(){t.defaultHoverShown=!0;t.setState({defaultHoverShown:t.defaultHoverShown})},this.hoverTimeout)},f.prototype.runMobileRoutine=function(){for(var i,n=this,t=0;t<this.hotSpots.length;t++)i=this.hotSpots[t],i.classList.remove(this.showHotspotClassName);setTimeout(function(){for(var i,t=0;t<n.hotSpots.length;t++)i=n.hotSpots[t],i.classList.add(n.showHotspotClassName)},this.hotspotDelay)},f.prototype.componentDidMount=function(){this.hotSpots&&this.hotSpots.length>0&&this.runHotSpotRoutine()},f.prototype.componentWillUpdate=function(){this.hotSpots=[]},f.prototype.componentDidUpdate=function(){this.hotSpots&&this.hotSpots.length>0&&this.runHotSpotRoutine()},f.prototype.render=function(){var i=this,r=ImageDetailActions.DetailScenario.VisualSearch,e=!this.props.enableVSNotification||this.props.detailScenario==r||n.ImageDetailUtils.getVSNotificationCookie("0"),u=!this.props.enableVSNotification||this.props.detailScenario!=r||n.ImageDetailUtils.getHSNotificationCookie("0");if(this.props&&this.props.config&&this.props.config.Enabled&&this.props.detectedObjects&&this.props.detectedObjects.length>0&&e){var f=this.props.config.EnableTooltip&&u?this.hotSpotTooltip:"",o=f?{"data-tooltip":f}:{},s=ImageDetailReducers.getResourceString("HSNotification"),h=u?"obj_det_container":"obj_det_container show";return React.createElement("div",{className:h,id:"obj_det_container"},this.props.detectedObjects.map(function(u,f){if(u.hotspot){var e=f==0&&i.props.config.EnableNotification&&!i.defaultHoverShown?"obj_det hover":"obj_det",h={left:u.hotspot.left*100+"%",top:u.hotspot.top*100+"%"};return React.createElement("span",__assign({},o,{className:e,key:f,style:h,onClick:function(){return i.handleOnClick(f)},ref:function(n){n&&i.hotSpots.push(n)}}),React.createElement("span",{className:"core"}),i.props.enableVSNotification&&i.props.detailScenario==r&&f==0&&React.createElement(t.NotificationContainer,{notificationTitle:null,notificationText:s,getCookie:n.ImageDetailUtils.getHSNotificationCookie,setCookie:n.ImageDetailUtils.setHSNotificationCookie}))}}))}return null},f}(React.Component),f=function(n){return{changeCropCoordinates:function(t){n(ImageDetailActions.changeCropCoordinates(t))},addToDetailStateHistory:function(){n(ImageDetailActions.addToDetailStateHistory())},switchDetailScenario:function(t){n(ImageDetailActions.switchDetailScenario(ImageDetailActions.DetailScenario.VisualSearch,t))}}},e=function(n){return{detectedObjects:ImageDetailReducers.getDetectedObjects(n),config:ImageDetailReducers.getObjectDetectionConfig(n),detailScenario:ImageDetailReducers.getDetailScenario(n),imageData:ImageDetailReducers.getCurrentResult(n),ig:ImageDetailReducers.getCurrentImpressionId(n)}};n.ImageDetail.ObjectDetection=ReactRedux.connect(e,f)(u);n.ImageDetail.ObjectDetection.displayName="ObjectDetection"})(t=n.ImageDetail||(n.ImageDetail={}))}(Multimedia||(Multimedia={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=n.ImageDetailUtils.getMouseClickPosition,r=n.ImageDetailUtils.getParentContainer,u=n.InstrumentationUtils.logEvent,f=function(n){function f(t){var r=n.call(this,t)||this;return r.entities=[],r.isEventListenerAttached=!1,r.isAnimationShown=!1,r.config=null,r.dismissEntityPane=function(){r.setState({clickedElement:null,style:null});typeof document!="undefined"&&(r.isEventListenerAttached=!1,document.removeEventListener("click",r.dismissEntityPane),document.removeEventListener("touchend",r.dismissEntityPane))},r.handleOnClick=function(n,t){var f,e,o;r.isEventListenerAttached||(f=i(n,r.config.EntityPaneXOffset,r.config.EntityPaneYOffset),e=sj_et(n),f=r.adjustPositionToParent(e,f),o=r.props.recognizedObjects[t],r.setState({clickedElement:o,style:{left:f[0]+"px",top:f[1]+"px",width:r.config.EntityPaneWidth+"px",height:r.config.EntityPaneHeight+"px"}}),typeof document!="undefined"&&(r.isEventListenerAttached=!0,document.addEventListener("click",r.dismissEntityPane),document.addEventListener("touchend",r.dismissEntityPane)),r.props.imageData&&r.props.imageData.instInfo&&u(r.props.imageData.instInfo.appNS,r.props.imageData.instInfo.kValue,"CI.Click","objectRecognitionFaceRect",r.props.ig,{Mid:r.props.imageData.id}))},r.config=ImageDetailReducers.getObjectRecognitionConfig(),r}return __extends(f,n),f.prototype.componentWillUpdate=function(){this.entities=[]},f.prototype.componentWillReceiveProps=function(){this.entities=[];this.isAnimationShown=!1;this.dismissEntityPane()},f.prototype.componentDidUpdate=function(){var t=this,n,i;if(this.entities&&this.entities.length>0&&!this.isAnimationShown&&this.config.EnableFlash){for(n=0;n<this.entities.length;n++)i=this.entities[n],i.style.animationName="",i.style.webkitAnimationName="";setTimeout(function(){for(var i,n=0;n<t.entities.length;n++)i=t.entities[n],i.style.animationName="flash",i.style.webkitAnimationName="flash";t.isAnimationShown=!0},1)}},f.prototype.componentWillUnMount=function(){typeof document!="undefined"&&this.isEventListenerAttached&&(document.removeEventListener("click",this.dismissEntityPane),document.removeEventListener("touchend",this.dismissEntityPane))},f.prototype.render=function(){var n=this;return this.config.Enabled&&this.props.recognizedObjects&&this.props.recognizedObjects.length>0?React.createElement("div",{className:"obj_rec",id:"obj_rec"},this.props.recognizedObjects.map(function(t,i){if(t.entity&&t.entity.imageUrl){var r={left:t.region.left*100+"%",top:t.region.top*100+"%",width:(t.region.right-t.region.left)*100+"%",height:(t.region.bottom-t.region.top)*100+"%"};return React.createElement("span",{className:"feature objrec",key:i,style:r,onClick:function(t){return n.handleOnClick(t,i)},ref:function(t){t&&n.entities.push(t)}})}return null}),this.state&&this.state.clickedElement&&React.createElement(t.ImageEntityPane,{entity:this.state.clickedElement.entity,style:this.state.style,ig:this.props.ig,imageData:this.props.imageData})):null},f.prototype.adjustPositionToParent=function(n,t){var u=r(n,"DIV","imgContainer");if(u){var i=u.getClientRects()[0],f=this.calculateNewPosition(t[0],this.config.EntityPaneWidth,i.left,i.right),e=this.calculateNewPosition(t[1],this.config.EntityPaneHeight,i.top,i.bottom);return[f,e]}return t},f.prototype.calculateNewPosition=function(n,t,i,r){var u,e,f;return n<0?0:(u=r-i,u<t)?u:(e=20,f=r-(i+n+t),f>0?n:Math.max(0,n+f-e))},f}(React.Component),e=function(n){var t=ImageDetailReducers.getRecognizedEntities(n);return{recognizedObjects:t,imageData:ImageDetailReducers.getCurrentResult(n),ig:ImageDetailReducers.getCurrentImpressionId(n)}};n.ImageDetail.ObjectRecognition=ReactRedux.connect(e)(f);n.ImageDetail.ObjectRecognition.displayName="ObjectRecognition"})(t=n.ImageDetail||(n.ImageDetail={}))}(Multimedia||(Multimedia={})),function(n){var t=function(){function n(n,t,i,r,u,f,e,o,s){e===void 0&&(e=!0);o===void 0&&(o=5);s===void 0&&(s=!1);var h=this;if(this.utils=pMMUtils,this.moved=!1,this.doubletap=!1,this.touchStartPoint=null,this.touchStartElementLeft=0,this.nowtouchpid=0,this.swipeDelta=null,this.touchStartTime=0,this.timeDelta=0,this.captureEvent=!0,this.enableEndHandlerWithoutMove=!1,this.moveSensitivity=5,this.cleanUp=function(){h.handleEventsSetting(!1)},this.isMoved=function(){return h.moved},this.resetMoved=function(){h.moved=!1},this.handleEventsSetting=function(n){var t=n?sj_be:sj_ue;"ontouchstart"in sb_de?(t(h.touchElement,"touchstart",h.touchStart,h.captureEvent),t(h.touchElement,"touchmove",h.touchMove,h.captureEvent),t(h.touchElement,"touchend",h.touchEnd,h.captureEvent)):window.navigator.msPointerEnabled?(h.touchElement.style.msTouchAction="none",h.touchElement.style.touchAction="none",t(h.touchElement,"MSPointerDown",h.touchStart,h.captureEvent),t(h.touchElement,"MSPointerMove",h.touchMove,h.captureEvent),t(h.touchElement,"MSPointerUp",h.touchEnd,h.captureEvent),t(_d,"MSPointerUp",h.touchEnd,h.captureEvent)):"onpointermove"in sb_de&&(h.touchElement.style.msTouchAction="none",h.touchElement.style.touchAction="none",t(h.touchElement,"pointerdown",h.touchStart,h.captureEvent),t(h.touchElement,"pointermove",h.touchMove,h.captureEvent),t(h.touchElement,"pointerup",h.touchEnd,h.captureEvent),t(_d,"pointerup",h.touchEnd,h.captureEvent));t(_d,"mousedown",h.resetMoved,!0)},this.getHandlerOrEmpty=function(n){return n!=null?n:h.Empty},this.Empty=function(){},this.setMoved=function(n){n===void 0&&(n=!1);h.moved=n},this.checkIfDoubleTap=function(){return sb_gt()-h.touchStartTime<250&&!!h.doubleTapHandler&&!h.isMoved()},this.touchStart=function(n){if(h.isTouchEvent(n)&&(h.doubletap=h.checkIfDoubleTap(),!h.doubletap)){h.setMoved(!1);h.touchStartPoint=h.getTouchPointFromEvent(n);var t=h.utils.gcs(h.touchElement);h.touchStartElementLeft=parseInt(typeof _G!="undefined"&&_G.RTL?t.marginRight:t.marginLeft);h.touchStartTime=sb_gt();!n.pointerId||(h.nowtouchpid=n.pointerId);h.touchStartHandler(n)}},this.touchMove=function(n){if(h.isTouchEvent(n)&&h.isValidTouch(n)){var t=h.getTouchPointFromEvent(n);if(!h.touchStartPoint||!t)return;h.swipeDelta=h.getDistanceBetweenPoints(h.touchStartPoint,t);h.setMoved(Math.abs(h.swipeDelta.X)>h.moveSensitivity||Math.abs(h.swipeDelta.Y)>h.moveSensitivity);h.isMoved()&&!h.doubletap&&h.touchMoveHandler(h.touchStartElementLeft,h.swipeDelta)&&h.preventDefault(n)}},this.touchEnd=function(n){var t=h.isMoved(),i;h.isTouchEvent(n)&&(h.doubletap&&!h.isMoved()?(h.doubleTapHandler(n),h.preventDefault(n),h.doubletap=!1):(t||h.enableEndHandlerWithoutMove)&&h.isValidTouch(n)&&(h.timeDelta=sb_gt()-h.touchStartTime,i=t?h.swipeDelta:h.getNewPoint(),h.touchEndHandler(h.touchStartElementLeft,i,h.timeDelta)&&h.preventDefault(n)),sj_ue(_d,"mousedown",h.resetMoved,!0),sb_st(function(){sj_be(_d,"mousedown",this.resetMoved,!0)},150))},this.preventDefault=function(n){n.stopPropagation();n.preventDefault()},this.getTouchPointFromEvent=function(n){var t=h.getNewPoint();return t.X=n.touches?n.touches[0].pageX:n.pageX!=undefined&&n.pageX!=0?n.pageX:0,t.Y=n.touches?n.touches[0].pageY:n.pageY!=undefined&&n.pageY!=0?n.pageY:0,t},this.getDistanceBetweenPoints=function(n,t){var i=h.getNewPoint();return i.X=t.X-n.X,i.Y=t.Y-n.Y,i},this.getNewPoint=function(){return{X:0,Y:0}},this.isTouchEvent=function(n){return typeof n.pointerType=="undefined"||n.pointerType==2||n.pointerType=="touch"||n.pointerType=="pen"},this.isValidTouch=function(n){return!n.pointerId||n.pointerId==h.nowtouchpid},!n)throw"container cannot be null!";this.container=n;this.touchElement=!t?this.container:t;this.touchStartHandler=this.getHandlerOrEmpty(i);this.touchMoveHandler=this.getHandlerOrEmpty(r);this.touchEndHandler=this.getHandlerOrEmpty(u);this.doubleTapHandler=this.getHandlerOrEmpty(f);this.enableEndHandlerWithoutMove=s;this.captureEvent=e;this.moveSensitivity=o;this.handleEventsSetting(!0)}return n}();n.MmReactSwipe=t}(ImageDetailSwipe||(ImageDetailSwipe={}))